<section id="appearance-detail">
  <div class='card'>
    <div class='card-header'>
      {{this.sortedAppearances.length}}
      {{prev-next model=this.model sortedArray=this.appearances}}
      <h4>
        #{{this.model.num}}: {{html-safe this.model.name}}
        {{#if (eq this.model.status 'Variance')}}
          {{download-variance model=this.model}}
        {{else if (eq this.model.status 'Verified')}}
          <FaIcon @icon='check-circle' class='text-success' />
        {{/if}}
     </h4>
    </div>
    <div class='card-body'>
      {{appearance-details model=this.model}}
      {{#if (or
        (eq this.model.status 'Started')
        (eq this.model.status 'Finished')
        (eq this.model.status 'Variance')
        (eq this.model.status 'Verified')
        (eq this.model.status 'Completed')
        (eq this.model.status 'Advanced')
      )}}
        <section>
          {{appearance-songs model=this.model}}

          {{#unless (eq this.model.round.status 'Published')}}
            {{#if this.model.entryId}}
              <p>
                <LinkTo @route='dashboard.conventions.convention.sessions.session.entries.entry' @model={{this.model.entryId}}>Update Repertory or contests on entry</LinkTo>
              </p>
            {{/if}}
          {{/unless}}
        </section>
      {{/if}}
      {{#if (or
        (eq this.model.status 'Variance')
        (eq this.model.status 'Finished')
        (eq this.model.status 'Verified')
        (eq this.model.status 'Completed')
        (eq this.model.status 'Advanced')
      )}}
        <section>
          {{appearance-panelists model=this.model onScoreChange=(action 'onScoreChange') setDisableCheckAppearance=(action 'setDisableCheckAppearance')}}
          <div class='text-end'>
            <ul class='list-inline'>
              <li class='list-inline-item'><h5>Practice Points: {{#if this.practicePoints}}<strong>{{this.practicePoints}}</strong>{{else}}N/A{{/if}}</h5></li>
              <li class='list-inline-item'><h4>Official Points: {{#if this.officialPoints}}<strong>{{this.officialPoints}}</strong>{{/if}}</h4></li>
            </ul>
          </div>
        </section>
        <section>
          {{appearance-penalties model=this.model}}
        </section>
      {{/if}}
      {{!-- <hr>
      <section>
        {{log-index model=this.model}}
      </section> --}}
    </div>
    <div class='card-footer'>
      {{prev-next model=this.model sortedArray=this.appearances}}
      <h4>
        #{{this.model.num}}: {{html-safe this.model.name}}
        {{#if (eq this.model.status 'Variance')}}
          {{download-variance model=this.model}}
        {{else if (eq this.model.status 'Verified')}}
          <FaIcon @icon='check-circle' class='text-success' />
        {{/if}}
     </h4>
    </div>
    <div class='card-footer actions'>
      <ul class='list-inline'>
        {{#if (eq this.model.status 'New')}}
          <li class='list-inline-item'>{{appearance-delete model=this.model}}</li>
        {{else if (eq this.model.status 'Built')}}
          <li class='list-inline-item primary'>{{appearance-start model=this.model}}</li>
          <li class='list-inline-item'>{{appearance-scratch model=this.model}}</li>
          <li class='list-inline-item'>{{appearance-mock model=this.model}}</li>
          <li class='list-inline-item disqualify'>{{appearance-disqualify model=this.model}}</li>
        {{else if (eq this.model.status 'Started')}}
          <li class='list-inline-item primary'>{{appearance-finish model=this.model}}</li>
          <li class='list-inline-item'>{{appearance-mock model=this.model}}</li>
          <li class='list-inline-item disqualify'>{{appearance-disqualify model=this.model}}</li>
        {{else if (or (eq this.model.status 'Finished') (eq this.model.status 'Variance'))}}
          <li class='list-inline-item'>{{appearance-verify model=this.model disableCheckAppearance=this.disableCheckAppearance}}</li>
          {{!-- <li class='list-inline-item'>{{appearance-scratch model=this.model}}</li> --}}
          <li class='list-inline-item disqualify'>{{appearance-disqualify model=this.model}}</li>
        {{else if (or (eq this.model.status 'Verified')(eq this.model.status 'Completed'))}}
          <li class='list-inline-item'>{{download-csa model=this.model}}</li>
          {{#unless (eq this.model.round.status 'Published')}}
            <li class='list-inline-item disqualify'>{{appearance-disqualify model=this.model}}</li>
          {{/unless}}
        {{/if}}
        <li class='ms-auto'><h4>Appearance Status: <strong>{{this.model.status}}</strong></h4></li>
      </ul>
    </div>
  </div>
</section>

{{#if (eq this.model.status 'Variance')}}
<BsModal
  @keyboard={{false}}
  @backdropClose={{false}}
  as |modal|
>
  <modal.header>
    <h4>Variance Generated</h4>
  </modal.header>
  <modal.body>
    The appearance has generated a variance. Please download the report and confirm if the appearnance can be verified.
    {{download-variance model=this.model}}
  </modal.body>
  <modal.footer>
    {{appearance-verify model=this.model disableCheckAppearance=this.disableCheckAppearance}}
    {{appearance-disqualify model=this.model}}
  </modal.footer>
</BsModal>
{{/if}}